{% extends './base.html' %}
{% load static %}
{% load explore_scotland_tags %}

{% block title_block %}Home{% endblock %}

{% block body_block %}
<div>
	<h2 class="homepagetitle text-center"><span style="color:#6495ED"> Share &</span>
	<span style="color:#DC143C"> Love </span> </h2>
</div>

<div class="row">
	<div class="col-8" style="height:40em;">
		<div id="photoCarousel" class="carousel slide" data-ride="carousel">
		  <ol class="carousel-indicators">
		  </ol>
		  <div class="carousel-inner">
		  </div>
		  <a class="carousel-control-prev" href="#photoCarousel" role="button" data-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span>
			<span class="sr-only">Previous</span>
		  </a>
		  <a class="carousel-control-next" href="#photoCarousel" role="button" data-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span>
			<span class="sr-only">Next</span>
		  </a>
		</div>

	</div>
	<div class="col-4">
		{% get_search_form %}
	</div>
</div>

{% endblock %}

{% block script_block %}
<script>

$('document').ready(function(){
	var url = "{% url 'explore_scotland_app:get_photos' %}";
	$.ajax(url,
	{
		dataType: 'json', // type of response data
		timeout: 500,     // timeout milliseconds
		success: function (data,status,xhr) {   // success callback function
			data = JSON.parse(data);
			var active = 'active';
			data.map((photo, i)=>{
				var photoMeta = `<li data-target="#photoCarousel" data-slide-to="${i}" class="${active}"></li>`
				var photoDiv = `<div class="carousel-item ${active} text-center">
									<a href='{% url 'explore_scotland_app:picture_details_without_key' %}${photo.pk}'>
										<img src="{{MEDIA_URL}}/${photo.fields.picture}" alt="" class="img-responsive" width="100%" height="auto">
									</a>
								</div>`;
				$('.carousel-indicators').append(photoMeta);
				$('.carousel-inner').append(photoDiv);
				active = '';
			});
		},
		error: function (jqXhr, textStatus, errorMessage) { // error callback 
			$('.carousel-inner').append('Error: ' + errorMessage);
		}
	});
});
</script>
{% endblock %}